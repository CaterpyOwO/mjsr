(()=>{"use strict";var __webpack_modules__={328:(t,e,r)=>{const i=1e-6;let n="undefined"!=typeof Float32Array?Float32Array:Array;function o(){let t=new n(16);return n!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});class s{constructor(t=[0,0,0],e=[0,0,0],r=6){return this.pos=t,this.rot=e,this}mvp(t){let e=function(t,e,r,i,n){let o,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,o=1/-99.9,t[10]=100.1*o,t[14]=20*o,t}(o(),Math.PI/180*45,t.width/t.height),r=function(t,e,r,n){let o,s,a,h,l,c,u,m,p,d,v=e[0],g=e[1],f=e[2],_=n[0],w=n[1],b=n[2],k=r[0],y=r[1],L=r[2];return Math.abs(v-k)<i&&Math.abs(g-y)<i&&Math.abs(f-L)<i?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(u=v-k,m=g-y,p=f-L,d=1/Math.hypot(u,m,p),u*=d,m*=d,p*=d,o=w*p-b*m,s=b*u-_*p,a=_*m-w*u,d=Math.hypot(o,s,a),d?(d=1/d,o*=d,s*=d,a*=d):(o=0,s=0,a=0),h=m*a-p*s,l=p*o-u*a,c=u*s-m*o,d=Math.hypot(h,l,c),d?(d=1/d,h*=d,l*=d,c*=d):(h=0,l=0,c=0),t[0]=o,t[1]=h,t[2]=u,t[3]=0,t[4]=s,t[5]=l,t[6]=m,t[7]=0,t[8]=a,t[9]=c,t[10]=p,t[11]=0,t[12]=-(o*v+s*g+a*f),t[13]=-(h*v+l*g+c*f),t[14]=-(u*v+m*g+p*f),t[15]=1,t)}(o(),this.pos,[0,0,0],[0,-1,0]);return function(t,e,r){let i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],l=e[6],c=e[7],u=e[8],m=e[9],p=e[10],d=e[11],v=e[12],g=e[13],f=e[14],_=e[15],w=r[0],b=r[1],k=r[2],y=r[3];return t[0]=w*i+b*a+k*u+y*v,t[1]=w*n+b*h+k*m+y*g,t[2]=w*o+b*l+k*p+y*f,t[3]=w*s+b*c+k*d+y*_,w=r[4],b=r[5],k=r[6],y=r[7],t[4]=w*i+b*a+k*u+y*v,t[5]=w*n+b*h+k*m+y*g,t[6]=w*o+b*l+k*p+y*f,t[7]=w*s+b*c+k*d+y*_,w=r[8],b=r[9],k=r[10],y=r[11],t[8]=w*i+b*a+k*u+y*v,t[9]=w*n+b*h+k*m+y*g,t[10]=w*o+b*l+k*p+y*f,t[11]=w*s+b*c+k*d+y*_,w=r[12],b=r[13],k=r[14],y=r[15],t[12]=w*i+b*a+k*u+y*v,t[13]=w*n+b*h+k*m+y*g,t[14]=w*o+b*l+k*p+y*f,t[15]=w*s+b*c+k*d+y*_,t}(o(),e,r)}model(){return o()}modelivt(){let t=o();return function(t,e){let r=e[0],i=e[1],n=e[2],o=e[3],s=e[4],a=e[5],h=e[6],l=e[7],c=e[8],u=e[9],m=e[10],p=e[11],d=e[12],v=e[13],g=e[14],f=e[15],_=r*a-i*s,w=r*h-n*s,b=r*l-o*s,k=i*h-n*a,y=i*l-o*a,L=n*l-o*h,E=c*v-u*d,P=c*g-m*d,M=c*f-p*d,A=u*g-m*v,x=u*f-p*v,C=m*f-p*g,T=_*C-w*x+b*A+k*M-y*P+L*E;T&&(T=1/T,t[0]=(a*C-h*x+l*A)*T,t[1]=(n*x-i*C-o*A)*T,t[2]=(v*L-g*y+f*k)*T,t[3]=(m*y-u*L-p*k)*T,t[4]=(h*M-s*C-l*P)*T,t[5]=(r*C-n*M+o*P)*T,t[6]=(g*b-d*L-f*w)*T,t[7]=(c*L-m*b+p*w)*T,t[8]=(s*x-a*M+l*E)*T,t[9]=(i*M-r*x-o*E)*T,t[10]=(d*y-v*b+f*_)*T,t[11]=(u*b-c*y-p*_)*T,t[12]=(a*P-s*A-h*E)*T,t[13]=(r*A-i*P+n*E)*T,t[14]=(v*w-d*k-g*_)*T,t[15]=(c*k-u*w+m*_)*T)}(t,t),function(t,e){if(t===e){let r=e[1],i=e[2],n=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=n,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(t,t),t}}class a{constructor(t={width:640,height:480},e=document.body,r){return r instanceof HTMLCanvasElement?this.canvas=r:this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height,this.gl=this.canvas.getContext("webgl"),this.parent=e,e instanceof HTMLElement&&e.appendChild(this.canvas),this}fullscreen(){this.canvas.width=innerWidth,this.canvas.height=innerHeight,window.addEventListener("resize",(()=>{this.canvas.width=innerWidth,this.canvas.height=innerHeight}));let t=document.createElement("style");return t.innerText="html,body{margin:0;overflow:hidden}",document.head.appendChild(t),this}fillParent(){return this.canvas.width=this.parent.clientWidth,this.canvas.height=this.parent.clientHeight,window.addEventListener("resize",(()=>{this.canvas.width=this.parent.clientWidth,this.canvas.height=this.parent.clientHeight})),this}square(t){return this.canvas.width=t,this.canvas.height=t,this}rect(t,e){return this.canvas.width=t,this.canvas.height=e,this}}const h={None:class{update(){}setAttributes(){}setupMovement(){}},FirstPerson:class{constructor(){this.keys=[]}setAttributes(t,e){this.screen=t,this.camera=e}setupMovement(){let{canvas:t}=this.screen;window.addEventListener("keydown",(t=>this.keys[t.key.toLowerCase()]=!0)),window.addEventListener("keyup",(t=>this.keys[t.key.toLowerCase()]=!1));let e=t=>Math.abs(t.movementX)>50||Math.abs(t.movementY)>50?void 0:this.mouseRotation([t.movementX,t.movementY]);t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,t.onclick=()=>t.requestPointerLock();let r=()=>{document.pointerLockElement===t||document.mozPointerLockElement===t?t.onmousemove=e:t.onmousemove=null};document.addEventListener("pointerlockchange",r),document.addEventListener("mozpointerlockchange",r)}mouseRotation(t,e=3){let[r,i]=t;r/=e*=100,i/=e,this.camera.rot[0]+i<Math.PI/2&&this.camera.rot[0]+i>-Math.PI/2&&(this.camera.rot[0]+=i),this.camera.rot[1]+=r}update(t){let{canvas:e}=this.screen;if(document.pointerLockElement==e||document.mozPointerLockElement==e){let e=t/160;(this.keys.q||this.keys[" "])&&(this.camera.pos[1]+=e),(this.keys.e||this.keys.Shift)&&(this.camera.pos[1]-=e);let r=e*Math.sin(this.camera.rot[1]),i=e*Math.cos(this.camera.rot[1]);this.keys.w&&(this.camera.pos[0]-=r,this.camera.pos[2]-=i),this.keys.s&&(this.camera.pos[0]+=r,this.camera.pos[2]+=i),this.keys.a&&(this.camera.pos[0]+=i,this.camera.pos[2]-=r),this.keys.d&&(this.camera.pos[0]-=i,this.camera.pos[2]+=r)}}},ModelRotate:class{constructor(){this.keys=[]}setAttributes(t,e){this.screen=t,this.camera=e}setupMovement(){let{canvas:t}=this.screen,e=[0,0];const r=t=>this.mouseRotation([t.movementX,t.movementY]);t.onmousedown=()=>t.onmousemove=r,window.onmouseup=()=>t.onmousemove=null,t.addEventListener("touchstart",(t=>e=[t.touches[0].screenX,t.touches[0].screenY]),{passive:!0}),t.addEventListener("touchmove",(t=>(this.mouseRotation([-(e[0]-t.touches[0].screenX),e[1]-t.touches[0].screenY]),e=[t.touches[0].screenX,t.touches[0].screenY])),{passive:!0}),t.addEventListener("touchend",(()=>(t.ontouchmove=null,e=[0,0])))}mouseRotation(t){let{pos:e}=this.camera;t[0]*=.01,this.camera.pos=this.rotate2d(e,-t[0],[0,2]),this.camera.rot[1]+=t[0]}rotate2d(t,e,r){let[i,n]=r,[o,s]=[t[i],t[n]],a=Math.sin(e),h=Math.cos(e);return t[i]=o*h-s*a,t[n]=s*h+o*a,t}update(){}}};function l(t){let e=[t[1][0]-t[0][0],t[1][1]-t[0][1],t[1][2]-t[0][2]],r=[t[2][0]-t[0][0],t[2][1]-t[0][1],t[2][2]-t[0][2]];return function(t){let e=Math.sqrt(t[0]**2+t[1]**2+t[2]**2);return[t[0]/=e,t[1]/=e,t[2]/=e]}([e[1]*r[2]-e[2]*r[1],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[0]])}function c(t){if("#"==!t.charAt(0))throw new Error(t+" is not a HEX colour.");return[...(t=3==(t=t.substr(1)).length?t.split("").reduce(((t,e)=>t.push(e+e)&&t),[]):t.match(/.{1,2}/g)).map((t=>{return e=parseInt(t,16)/255,0,1,Math.max(Math.min(e,1),0);var e})),1]}class u{constructor(t){return this.gl=t,this.shaders=[],this.glprogram=null,this}frag(t){this.shader(t,this.gl.FRAGMENT_SHADER)}vert(t){this.shader(t,this.gl.VERTEX_SHADER)}shader(t,e){if(t=t.raw?t.raw.join(""):t,!e){let r=new RegExp("// ?vert(ex)?( |_|-)shader","i"),i=new RegExp("// ?frag(ment)?( |_|-)shader","i");if(r.test(t))e=this.gl.VERTEX_SHADER;else{if(!i.test(t))throw new Error("No shader type found.");e=this.gl.FRAGMENT_SHADER}}let r=this.gl.createShader(e);if(this.gl.shaderSource(r,t),this.gl.compileShader(r),this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS))return this.shaders.push(r),r;console.error("Error in shader:\n"+t.split(/\n/).map(((t,e)=>`${e+1}: ${t}`)).join("\n"));let i=new Error(this.gl.getShaderInfoLog(r));throw this.gl.deleteShader(r),i}program(...t){if(0==t.length&&(t=this.shaders),0==t.length)throw new Error("No shaders were supplied.");let e=this.gl.createProgram();for(let r of t)this.gl.attachShader(e,r);if(this.gl.linkProgram(e),this.gl.getProgramParameter(e,this.gl.LINK_STATUS))return this.glprogram=e,e;let r=new Error(this.gl.getProgramInfoLog(e));throw this.gl.deleteProgram(e),r}buffers(t,e){if(0==t.length)throw new Error("No buffers were supplied.");for(let r in t){let i=t[r];this.buffer32f(i,this.gl.ARRAY_BUFFER);let n=this.gl.getAttribLocation(this.glprogram,r);this.gl.enableVertexAttribArray(n),e[r]?this.gl.vertexAttribPointer(n,e[r],this.gl.FLOAT,!1,0,0):this.gl.vertexAttribPointer(n,3,this.gl.FLOAT,!1,0,0)}}buffer32f(t,e){let r=this._bufferInit(e);return this.gl.bufferData(e,new Float32Array(t),this.gl.STATIC_DRAW),r}buffer16u(t,e){let r=this._bufferInit(e);return this.gl.bufferData(e,new Uint16Array(t),this.gl.STATIC_DRAW),r}buffer32u(t,e){let r=this._bufferInit(e);return this.gl.bufferData(e,new Uint32Array(t),this.gl.STATIC_DRAW),r}_bufferInit(t){const e=this.gl.createBuffer();return this.gl.bindBuffer(t,e),e}}var m=r(930);function p(t={primitive:2,lighting:!0}){return(0,m.d)("\n    precision mediump float;\n\n    attribute vec4 position;\n    attribute vec4 colour;\n    attribute vec3 normal;\n\n    varying vec4 v_colour;\n    varying vec3 v_normal;\n\n\tvarying vec3 v_fragPos, v_viewPos;\n\n    uniform mat4 u_vp, u_model, u_modelivt;\n    vec3 u_pos = vec3(0, -2.0, -5.0);\n\n        \n    vec4 project(vec4 vertex) {\n        mat4 mvp = u_vp * u_model;\n\n        return mvp * vertex;\n    }\n\n\n    #if (options.lighting)\n        vec3 light = vec3(0.0, 2.0, -5.0);\n    #endif\n\n    void main() {\n        v_colour = colour;\n\n        #if (options.primitive == 2 && options.lighting) \n            v_fragPos = vec3(u_model * position);\n            v_normal = mat3(u_modelivt) * normal;\n        #endif\n\n        #if (options.primitive == 0)\n            gl_PointSize = 5.0;\n        #endif\n\n        gl_Position = project(position);\n    }\n    ",t)}function d(t={primitive:2,lighting:!0,mono:!1}){return(0,m.d)("\nprecision mediump float;\n\nvarying vec3 v_normal;\nvarying vec4 v_colour;\n\n#if options.lighting\n\tvarying vec3 v_fragPos, v_viewPos;\n\tvec3 light = vec3(0.0, 2.0, -5.0);\n#endif\n\nvoid main() {\n\t#if options.mono\n\t\t\nfloat lum = (v_colour.r + v_colour.g + v_colour.b) / 3.0;\nvec2 monoColour = vec2(lum, v_colour.a);\n\ngl_FragColor = monoColour.xxxy;\n\t#else\n\t\tgl_FragColor = v_colour;\n\t#endif\n\n\t#if options.lighting\n\t\t// vec3 normal = normalize(v_normal);\n\n\t\t// vec3 sToLightD = normalize(v_sToLight);\n\t\t// vec3 sToViewD = normalize(v_sToView);\n\n\t\t// vec3 halfVector = normalize(sToLightD + sToViewD);\n\n\t\t// float light = dot(normal, sToLightD);\n\t\t// float specular = 0.0;\n\t\t\n\t\t// gl_FragColor = v_colour;\n\n\t\t// gl_FragColor.rgb += 0.1;\n\t\t// gl_FragColor.rgb *= light;\n\n\t\t// if (light > 0.0) {\n\t\t// \tspecular = pow(dot(normal, halfVector), 100.0);\n\t\t// \tgl_FragColor.rgb += specular;\n\t\t// }\n\n\t\tvec3 lightColour = vec3(1.0, 1.0, 1.0);\n\n\t\tvec3 normal = normalize(v_normal);\n\t\tvec3 lightd = normalize(light - v_fragPos);\n\n\t\t// specular\n\t\tfloat strength = 0.3;\n\t\tvec3 viewd = normalize(v_viewPos - v_fragPos);\n\t\tvec3 reflectd = reflect(-lightd, normal);\n\n\t\tfloat sp = pow(max(dot(viewd, reflectd), 0.0), 32.0);\n\t\tvec3 specular = strength * sp * lightColour;  \n\n\t\t// diffuse\n\t\tfloat df = max(dot(normal, lightd), 0.0);\n\t\tvec3 diffuse = df * lightColour;\n\n\t\t// ambient\n\t\tvec3 ambient = 0.1 * lightColour;\n\t\t\n\n\t\tgl_FragColor = vec4(clamp((ambient + diffuse + specular), 0.2, 1.5) * v_colour.rgb, v_colour.a);\t\n\t#endif\n}",t)}t=r.hmd(t);const v={Renderer:class{constructor(t=new a,e=new s,r=new h.None){return this.screen=t,this.camera=e,r.setAttributes(t,e),this.input=r,this.dt=0,this.last=0,this}setup(t){this.scene=t,this.meshes=[],this.primitives=new Set,this.shaders={};for(let t of this.scene){if("object"!=typeof t)throw new Error("Invalid object in scene.");const e={0:["coords","verts","colours","primitive"],1:["coords","verts","edges","colours","primitive"],2:["coords","verts","faces","colours","primitive"]},r=["points","lines","triangles"];let i;if("string"!=typeof t.primitive||void 0===r.includes(t.primitive))throw new Error("No primitive type supplied.");i=r.indexOf(t.primitive);for(let r of e[i])if(void 0===t[r])throw new Error(`Object doesn't have required property ${r}.`);let n={position:[],colour:[],normal:[],primitive:i};switch(i){case 0:for(let e of t.verts){let r=c(t.colours[e[3]]);n.position.push(e[0],e[1],e[2]),n.colour.push(...r)}break;case 1:for(let e of t.edges){let r=c(t.colours[e[2]]);n.position.push(...t.verts[e[1]],...t.verts[e[0]]),n.colour.push(...r,...r)}break;case 2:for(let e of t.faces){let r=l([t.verts[e[0]],t.verts[e[1]],t.verts[e[2]]]),i=c(t.colours[e[3]]);n.position.push(...t.verts[e[2]],...t.verts[e[1]],...t.verts[e[0]]),n.colour.push(...i,...i,...i),n.normal.push(...r,...r,...r)}}this.primitives.add(i),this.meshes.push(n)}const{gl:e}=this.screen;for(let t of this.primitives){let r=new u(e),i=2==t;r.vert(p({lighting:i,primitive:t})),r.frag(d({lighting:i,primitive:t,mono:!1})),r.program(),this.shaders[t]=r}e.clearColor(1,1,1,1),e.enable(e.DEPTH_TEST),e.enable(e.CULL_FACE),this.input.setupMovement()}draw(){const{gl:t}=this.screen;let e=[t.POINTS,t.LINES,t.TRIANGLES];t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);for(let e in this.shaders){let r=this.shaders[e];t.useProgram(r.glprogram),t.uniform3fv(t.getUniformLocation(r.glprogram,"u_pos"),this.camera.pos),t.uniformMatrix4fv(t.getUniformLocation(r.glprogram,"u_modelivt"),!1,this.camera.modelivt()),t.uniformMatrix4fv(t.getUniformLocation(r.glprogram,"u_model"),!1,this.camera.model()),t.uniformMatrix4fv(t.getUniformLocation(r.glprogram,"u_vp"),!1,this.camera.mvp(this.screen.canvas)),t.useProgram(null)}for(let r of this.meshes){const i=r.primitive,n=this.shaders[i];t.useProgram(n.glprogram);let o={position:r.position,colour:r.colour};2==r.primitive&&(o.normal=r.normal),n.buffers(o,{colour:4}),t.drawArrays(e[i],0,r.position.length/(i+1)),t.useProgram(null)}}update(t){this.dt=this.last-t,this.last=t,this.input.update(this.dt)}},Screen:a,Camera:s,Input:h,Geometry:{Cube:class{constructor(t=[0,0,0]){let[e,r,i]=t;this.coords=t,this.primitive="triangles",this.verts=[[e-1,r-1,i-1],[e+1,r-1,i-1],[e+1,r+1,i-1],[e-1,r+1,i-1],[e-1,r-1,i+1],[e+1,r-1,i+1],[e+1,r+1,i+1],[e-1,r+1,i+1]],this.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],this.faces=[[0,1,2,0],[2,3,0,0],[1,5,6,1],[6,2,1,1],[4,5,1,2],[1,0,4,2],[6,5,4,3],[4,7,6,3],[7,4,0,4],[0,3,7,4],[2,6,7,5],[7,3,2,5]],this.colours=["#0ff","#0f0","#f0f","#00f","#ff0","#f00"]}},Plane:class{constructor(t=[0,0,0]){this.coords=t;let[e,r,i]=t;this.primitive="triangles",this.verts=[[e-1,r,i-1],[e-1,r,i+1],[e+1,r,i+1],[e+1,r,i-1]],this.faces=[[0,1,2,0],[2,3,0,0],[2,1,0,1],[0,3,2,1]],this.colours=["#faf","#aff"]}}}};"function"==typeof define&&r.amdO?define([],(()=>v)):"object"==typeof exports?t.exports=v:window.mjsr=v},930:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function preprocess(source,options){let lines=source.split(/\n/),lineCount=lines.length,output="";return traverse(),output.trim();function traverse(currentLine=0,condition=!0,prevCond=!0){for(;currentLine<lineCount;){let line=lines[currentLine];if(line.trim().startsWith("#"))switch(line.trim().substr(1).split(/\s/)[0]){case"if":prevCond=condition,currentLine=traverse(currentLine+1,eval(line.trim().substr(3)),prevCond);break;case"else":currentLine=traverse(currentLine+1,!condition,prevCond);break;case"endif":currentLine=traverse(currentLine+1,prevCond)}else condition&&(output+=line+"\n");currentLine++}return currentLine}}__webpack_require__.d(__webpack_exports__,{d:()=>preprocess})}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.loaded=!0,e.exports}__webpack_require__.amdO={},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__(328)})();